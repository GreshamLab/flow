---
title: "R Notebook"
"Flow Cytometry Gating"
author: 'G. Avecilla, N. Brandt, S. Lauer, F. Abdul-Rahman, D. Gresham'
date: '`r Sys.Date()`'
output: html_document
runtime: shiny
---

This script is intended to read in .fcs files and perform manual gating for

1. single cells 
2. debris
3. (optionally) fluorescence

This script requires a .csv samplesheet and user defined variables.
The user must define which controls are present, and the strain name for these controls.
**Currently this script only gates fluorescence using the FL1 (GFP) filter**  
If controls are not present, the script will only gate for singlets and debris. 
Sometimes gating must be done individually for groups of samples in different conditions (i.e., grown in different media). If so, the user must set the gate_by variable to the column name by which to group the data. There must be a set of controls for each condition.

Gating is performed with untransformed data.

Individual gates are saved in a .Rdata file for use with the Gresham Lab Flow Cytometry Analysis.Rmd pipeline.


```{r}
#Load libraries
library(tidyverse)
library(flowCore)
library(flowViz)
```


**Variables and Output Settings**

```{r Set user defined variables}
#working directory
dir = '.'

#file location of fcs and sampleshhet
path.data = paste(getwd(),"/",sep="")

#fcs run sample name
name = "Test"

#samplesheet parameters
sample.param <- data.frame(SAMPLE=NA, WELL=NA, STRAIN=NA, GENOTYPE=NA, PLOIDY=NA, MEDIA=NA, EXPERIMENT=NA)

#set control names (strain name in samplesheet)
zero_ctrl = NA
one_ctrl = NA
two_ctrl = NA

#set condition to gate by
gate_by = NA

#set output .Rdata name
out_rdata = paste(name, 'gates', Sys.Date(), sep = '_')
```

